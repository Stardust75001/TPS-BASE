{% comment %} Admin helper: shows broken-links count and a clear button when ?linkdebug=1 {% endcomment %}
<script>
(function(){
  try{
    var params = new URLSearchParams(location.search);
    if(params.get('linkdebug')!== '1') return;
    var wrap = document.createElement('div');
    wrap.style.cssText = 'position:fixed;right:12px;bottom:12px;z-index:2147483647;background:#111;color:#fff;padding:8px 10px;border-radius:6px;font:13px/1.2 -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Arial,sans-serif;box-shadow:0 6px 16px rgba(0,0,0,.3)';
    var count = (JSON.parse(localStorage.getItem('brokenLinks')||'[]')||[]).length;
    wrap.innerHTML = 'Broken links: <strong id="__bl_count">'+count+'</strong> ' +
      '<button id="__bl_refresh" style="margin-left:8px;padding:4px 8px;border-radius:4px;border:1px solid #444;background:#222;color:#fff;cursor:pointer">Refresh</button>' +
      '<button id="__bl_clear" style="margin-left:6px;padding:4px 8px;border-radius:4px;border:1px solid #444;background:#b00020;color:#fff;cursor:pointer">Clear</button>';
    document.addEventListener('DOMContentLoaded', function(){ document.body.appendChild(wrap);});
    function update(){ try{ document.getElementById('__bl_count').textContent = (JSON.parse(localStorage.getItem('brokenLinks')||'[]')||[]).length; }catch(_){} }
    wrap.querySelector('#__bl_refresh').addEventListener('click', update);
    wrap.querySelector('#__bl_clear').addEventListener('click', function(){ localStorage.removeItem('brokenLinks'); update(); });
  }catch(e){}
})();
</script>
